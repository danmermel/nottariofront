---
layout: minimal
title: Nottario
---

<script>
  var u = 'https://7xgnabn4wl.execute-api.eu-west-1.amazonaws.com/default/nottarioFiats3Upload';

  function allowDrop(ev) {
    ev.preventDefault();
    app.dragging = true;
    $("#drop_zone").addClass("dragging");
  }

  function dragout(ev) {
    console.log('drag out');
    app.dragging=false;
    $("#drop_zone").removeClass("dragging");
  }

  function drop_handler(ev) {
    console.log("Drop");
    ev.preventDefault();
    console.log('ev is', ev);
    var f = ev.dataTransfer.files[0]
    console.log(f.name, f.size, f.type)
    var formData = new FormData()
    formData.append('file', f)
    uploadForm(formData);    
  }

  // upload a file to S3 using a pre-signed URL
  function uploadForm(formData) {

    // get me a pre-signed URL
    getURL().then(function(data) {

      // make a PUT request to upload the file
      var req = {
        method: 'PUT',
        body: formData
      };
      return fetch(data.url, req);
    }).then(function(data) { 
      // success
      console.log('Uploaded')
    }).catch(function(){ 
      console.log('Failed');
    });
  }


  var getURL=function() {
    return fetch(u).then(function(data) {
      var j = data.json()      
      console.log('success', j)
      return j;
    }).catch(function(error) {
      console.log('error', error);
    });
  }

</script>

<a class="btn" href="#" onclick="getURL()">Get URL</a>


<div id="drop_zone" ondrop="drop_handler(event);" ondragover="allowDrop(event)" ondragleave="dragout(event)">
  <h3 class="text-center">Drag and drop a file here, or...</h3>
   <div class="text-center">
     <input class="btn btn-secondary" type="file" id="fileselect" name="fileselect" onchange="onFileSelect(this)">
   </div>
</div>
